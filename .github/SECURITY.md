# 安全政策

## 支持的版本

我们为以下版本提供安全更新支持：

| 版本 | 支持状态 |
|------|---------|
| 0.1.x (Beta) | ✅ 支持 |
| < 0.1.0 | ❌ 不支持 |

---

## 报告安全漏洞

我们非常重视项目的安全性。如果您发现了安全漏洞，请遵循负责任的披露流程。

### 🚨 重要提示

**请不要在公开的 GitHub Issues 中报告安全漏洞！**

### 报告方式

请通过以下任一方式报告安全问题：

#### 方法 1: GitHub Security Advisories（推荐）

1. 访问 [Security Advisories 页面](https://github.com/Yuxu-Palace/yuheng-dispatch/security/advisories)
2. 点击 "Report a vulnerability"
3. 填写漏洞详情

#### 方法 2: 私密邮件

发送邮件至：**snailuu@foxmail.com**

（如果该邮箱不存在，请通过创建 Private Security Advisory 报告）

### 报告内容

请在报告中包含以下信息：

- **漏洞类型**: 例如 XSS、注入、权限提升等
- **影响版本**: 受影响的版本范围
- **漏洞描述**: 详细描述漏洞的工作原理
- **复现步骤**: 如何重现此漏洞
- **影响评估**: 漏洞的潜在影响
- **修复建议**: 如果有修复建议（可选）
- **PoC 代码**: 概念验证代码（如果安全）

---

## 响应流程

我们承诺：

1. **确认收到**: 在 **48 小时**内确认收到您的报告
2. **初步评估**: 在 **1 周**内完成初步评估和影响分析
3. **修复开发**: 根据严重程度，在 **2-4 周**内开发修复方案
4. **安全发布**: 发布安全补丁并公开披露（协调披露时间）
5. **致谢感谢**: 在安全公告中感谢报告者（如果您同意）

### 严重程度等级

| 等级 | 响应时间 | 修复时间 |
|------|---------|---------|
| 🔴 严重 (Critical) | 24小时 | 1周 |
| 🟠 高 (High) | 48小时 | 2周 |
| 🟡 中 (Medium) | 1周 | 4周 |
| 🟢 低 (Low) | 2周 | 适时 |

---

## 安全更新策略

### 发布流程

1. **私密修复**: 在私有分支开发修复
2. **Beta 测试**: 在 beta 分支发布测试版本
3. **安全发布**: 发布正式版本
4. **公开披露**: 发布安全公告 (CVE/GHSA)
5. **用户通知**: 通过 Release Notes 和 CHANGELOG 通知用户

### 版本号约定

安全补丁遵循语义化版本：

- **Patch 版本**: 修复安全漏洞但不影响 API
- **Minor 版本**: 修复安全漏洞但添加新功能
- **Major 版本**: 修复需要破坏性变更的安全问题

---

## 安全最佳实践

### 使用本 Action 的安全建议

1. **最小权限原则**
   ```yaml
   permissions:
     contents: write        # 仅授予必要权限
     pull-requests: write
     issues: write
   ```

2. **Token 安全**
   - 使用 `secrets.GITHUB_TOKEN` 而不是个人 PAT
   - 确保 Token 权限最小化
   - 定期轮换 PAT（如果使用）

3. **分支保护**
   - 为 `main` 和 `beta` 分支启用分支保护
   - 要求 PR 审查
   - 要求状态检查通过

4. **审查变更**
   - 定期审查 Action 运行日志
   - 检查自动生成的 commit 和 tag
   - 监控异常的版本升级

### 开发者安全提示

- ❌ 不要在代码中硬编码敏感信息
- ❌ 不要提交 `.env` 文件或密钥
- ✅ 使用 GitHub Secrets 存储敏感数据
- ✅ 定期审查依赖的安全漏洞 (`pnpm audit`)
- ✅ 保持依赖更新到最新的安全版本

---

## 已知安全考虑

### 当前安全措施

1. **输入验证**: 所有用户输入都经过验证
2. **最小权限**: Action 只请求必要的权限
3. **错误处理**: 敏感信息不会泄露在错误消息中
4. **依赖安全**: 定期审查和更新依赖

### 潜在风险点

1. **Git 操作**: 自动 commit 和 push 可能被滥用
   - 缓解措施: 分支保护规则

2. **Token 使用**: 需要 write 权限
   - 缓解措施: 使用 GITHUB_TOKEN，避免 PAT

3. **PR 评论**: 可能包含用户数据
   - 缓解措施: 不记录敏感信息

---

## 安全审计

最后一次安全审计：**2024-12-17**

审计范围：
- ✅ 依赖漏洞扫描
- ✅ 代码安全审查
- ✅ 权限最小化验证
- ✅ 输入验证审查

---

## 联系方式

- **安全问题**: 使用 GitHub Security Advisories 或邮件 snailuu@foxmail.com
- **一般问题**: [GitHub Issues](https://github.com/Yuxu-Palace/yuheng-dispatch/issues)
- **讨论**: [GitHub Discussions](https://github.com/Yuxu-Palace/yuheng-dispatch/discussions)

---

**感谢您帮助我们保持项目安全！** 🛡️
